# Helper script for installation of compiler-specific support
# libraries from each subdirectory.  This should NOT be run directly.
# It is sourced by other install scripts.

# Use the installer from the root of the source tree.
INSTALL=`pwd`"/install-sh -c"
INSTALL_PROGRAM="${INSTALL}"
INSTALL_DATA="${INSTALL} -m 644"

# Use default prefix unless an argument was given to the script that sourced
# this one.
PREFIX=/usr/local
if [ x"$1" != x ] ; then
  PREFIX=$1
fi

# This function is called from install scripts in each subdirectory to
# install its files.  The function takes three arguments:
# install_directory "Subdirectory/Path" "list of header files" "list of programs"
install_directory()
{
  SUBDIR=$1
  HEADERS=$2
  PROGRAMS=$3
  
  # Create the installation subdirectory.
  if [ ! -d ${PREFIX}/share/GCC_XML/${SUBDIR} ] ; then
    echo "Making directory ${PREFIX}/share/GCC_XML/${SUBDIR} "
    mkdir -p ${PREFIX}/share/GCC_XML/${SUBDIR} &&
    chmod 755 ${PREFIX}/share/GCC_XML/${SUBDIR}
  fi
  
  # Install all headers from this directory listed in the "HEADERS" argument.
  for i in $HEADERS ; do
    echo "Installing ${SUBDIR}/$i ..."
    if [ -f ${SUBDIR}/$i ] ; then
      (cd ${SUBDIR}; ${INSTALL_DATA} $i ${PREFIX}/share/GCC_XML/${SUBDIR})
    else
       echo " ERROR!!! Unable to find: ${SUBDIR}/$i "
    fi
  done
  
  # Install all programs from this directory listed in the "PROGRAMS" argument.
  for i in $PROGRAMS ; do
    echo "Installing ${SUBDIR}/$i ..."
    if [ -f ${SUBDIR}/$i ] ; then
       (cd ${SUBDIR}; ${INSTALL_PROGRAM} $i ${PREFIX}/share/GCC_XML/${SUBDIR})
    else
       echo " ERROR!!! Unable to find: ${SUBDIR}/$i "
    fi
  done    
}
